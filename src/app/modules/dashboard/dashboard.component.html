<div class="grid grid-cols-6 gap-8 items-center">
  <div class="col-span-3">
    <label for="roleControl" class="text-gray-500 font-bold">Role: {{ displayFriendlyRole() }}</label>
  </div>
  <div class="col-span-3 ml-auto">
    @if(displayFilters) {
    <mat-form-field class="pr-2">
      <mat-label>State:</mat-label>
      <mat-select id="stateControl" [(ngModel)]="selectedState"
        (selectionChange)="changeSelectedState($event.value); applyFilter()">
        <mat-option value="all">All</mat-option>
        <mat-option *ngFor="let state of states" [value]="state.value">{{ state.label }}</mat-option>
      </mat-select>
    </mat-form-field>

    <!-- Service Dropdown -->
    @if(role === 'admin') {
    <mat-form-field class="pr-2">
      <mat-label>Service:</mat-label>
      <mat-select id="serviceControl" [(ngModel)]="selectedService"
        (selectionChange)="changeSelectedService($event.value); applyFilter()">
        <mat-option value="all">All</mat-option>
        <mat-option *ngFor="let service of services" [value]="service.value">{{ service.label }}</mat-option>
      </mat-select>
    </mat-form-field>
    }

    <mat-form-field class="px-2 bg-white">
      <mat-label class="">Enter a date range</mat-label>
      <mat-date-range-input #dateRangePicker [rangePicker]="picker" [min]="minDate" [max]="maxDate">
        <input matStartDate placeholder="Start date" [(ngModel)]="selectedStartDate">
        <input matEndDate placeholder="End date" [(ngModel)]="selectedEndDate">
      </mat-date-range-input>
      <mat-hint class="bg-white text-gray-500">MM/DD/YYYY â€“ MM/DD/YYYY</mat-hint>
      <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-date-range-picker #picker></mat-date-range-picker>
    </mat-form-field>

    <a href="#" (click)="toggleFilters(); removeFilter()">
      <mat-icon>filter_list_off</mat-icon>
    </a>
    }
    @else {
    <a href="#" (click)="toggleFilters()">
      <mat-icon>filter_list</mat-icon>
    </a>
    }
  </div>
</div>
<div class="dashboard-content-wrapper bg-blue-50">
  @if(privacyData && privacyData.length > 0) {
  <div class="grid grid-cols-6 gap-2 text-xl my-8">
    <div class="col-span-6 p-4">
      <div class="card">
        <div class="card-header pb-4">
          <p class="text-3xl font-bold">Privacy requests metrics</p>
        </div>
        <div class="card-body">
          <div class="grid grid-cols-6 gap-1 rounded border-t-2 border-l-2 border-b-2 border-gray-500">
            <div class="col-span-1 border-r-2 border-gray-500 text-amber-700">
              <div class="card">
                <div class="card-header min-h-[8rem] text-center">
                  <p class="text-xl font-semibold p-8">Total</p>
                </div>
                <div class="card-body p-8 text-8xl text-center">
                  <p>{{ requestStats.all }}</p>
                </div>
              </div>
            </div>
            <div class="col-span-1 border-r-2 border-gray-500 text-emerald-700">
              <div class="card">
                <div class="card-header min-h-[8rem] text-center">
                  <p class="text-xl font-semibold p-8">Processed</p>
                </div>
                <div class="card-body p-8 text-8xl text-center">
                  <p>{{ requestStats.completed }}</p>
                </div>
              </div>
            </div>
            <div class="col-span-1 border-r-2 border-gray-500 text-blue-700">
              <div class="card">
                <div class="card-header min-h-[8rem] text-center">
                  <p class="text-xl font-semibold p-8">Non-Processed</p>
                </div>
                <div class="card-body p-8 text-8xl text-center">
                  <p>{{ requestStats.pending }}</p>
                </div>
              </div>
            </div>
            <div class="col-span-1 border-r-2 border-gray-500 text-slate-700">
              <div class="card">
                <div class="card-header min-h-[8rem] text-center">
                  <p class="text-xl font-semibold p-8">Rejected</p>
                </div>
                <div class="card-body p-8 text-8xl text-center">
                  <p>{{ requestStats.rejected }}</p>
                </div>
              </div>
            </div>
            <div class="col-span-2 rounded border-r-2 border-gray-500 px-4"
              [ngClass]="isSLADataUnavailable()? '':'py-8'">
              @if(isSLADataUnavailable()) {
              <div class="card">
                <div class="card-header min-h-[8rem] text-center">
                  <p class="text-xl font-bold p-8">SLA Compliance</p>
                </div>
                <div class="card-body p-8 text-gray-500 text-base text-center">
                  <p>No SLA data available</p>
                </div>
              </div>
              } @else {
              <div echarts [options]="slaChartOption" class="h-full"></div>
              }
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-span-2 p-4">
      <!-- Request type distribution chart for Non-processed requests -->
      <div class="card rounded border-2 border-gray-500 p-4">
        <div class="card-body">
          <div echarts [options]="requestTypeChartOption" class="h-full"></div>
        </div>
      </div>
    </div>
    <div class="col-span-4 p-4">
      <!-- Heatmap of service owners against request types for non-processed requests -->
      <div class="card rounded border-2 border-gray-500 p-4">
        <div class="card-body">
          <div echarts [options]="serviceOwnerChartOption" class="h-full"></div>
        </div>
      </div>
    </div>
    <!-- <div class="col-span-6 rounded-md border border-emerald-300 shadow-md p-4">
      <div class="card">
        <div class="card-header pb-4">
          <p class="text-3xl font-bold">Consent based requests metrics</p>
        </div>
        <div class="card-body">
          <div class="grid grid-cols-6 gap-8">
            <div class="col-span-1">
              <div class="card rounded-xl border-2 bg-blue-700 text-white">
                <div class="card-header min-h-[8rem]">
                  <p class="text-xl font-semibold p-8">Total opt outs</p>
                </div>
                <div class="card-body p-8 text-8xl text-center">
                  <p>{{ getTotalOptOuts() }}</p>
                </div>
              </div>
            </div>
            <div class="col-span-1">
              <div class="card rounded-xl border-2 bg-green-700 text-white">
                <div class="card-header min-h-[8rem]">
                  <p class="text-xl font-semibold p-8">Opt outs processed</p>
                </div>
                <div class="card-body p-8 text-8xl text-center">
                  <p>{{ getTotalOptOutsCompleted() }}</p>
                </div>
              </div>
            </div>
            <div class="col-span-1">
              <div class="card rounded-xl border-2 bg-orange-700 text-white">
                <div class="card-header min-h-[8rem]">
                  <p class="text-xl font-semibold p-8">Opt outs in process</p>
                </div>
                <div class="card-body p-8 text-8xl text-center">
                  <p>{{ getTotalOptOutsPending() }}</p>
                </div>
              </div>
            </div>
            <div class="col-span-1">
              <div class="card rounded-xl border-2 bg-slate-700 text-white">
                <div class="card-header min-h-[8rem]">
                  <p class="text-xl font-semibold p-8">Rejected opt outs</p>
                </div>
                <div class="card-body p-8 text-8xl text-center">
                  <p>{{ getTotalOptOutsRejected() }}</p>
                </div>
              </div>
            </div>
            <div class="col-span-1">
              <div class="card rounded-xl border-2 bg-yellow-700 text-white">
                <div class="card-header min-h-[8rem]">
                  <p class="text-xl font-semibold p-8">Opt outs nearing breach</p>
                </div>
                <div class="card-body p-8 text-8xl text-center">
                  <p>{{ getTotalOptOutsNearingSLAInAWeek() }}</p>
                </div>
              </div>
            </div>
            <div class="col-span-1">
              <div class="card rounded-xl border-2 bg-red-700 text-white">
                <div class="card-header min-h-[8rem]">
                  <p class="text-xl font-semibold p-8">Opt outs in breach</p>
                </div>
                <div class="card-body p-8 text-8xl text-center">
                  <p>{{ getTotalOptOutsBreached() }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div> -->
  </div>
  } @else {
  <!-- Display No data in a tailwind formatted center box -->
  <div class="grid grid-cols-6 gap-16 text-xl my-8">
    <div class="col-span-6 shadow-md p-4">
      <div class="card">
        <div class="card-header pb-4">
          <p class="text-3xl font-bold">No data found</p>
        </div>
      </div>
    </div>
  </div>
  }
</div>

<!-- No data found container -->
<!-- Privacy metrics - total requests, processed, non-processed -->
<!-- Based on service owner selection, the privacy metrics should contain link to display tracking tab with appropriate service-owner pending requests -->
<!-- Consent based request numbers - total, processed & non-processed with service-owner selection and tracking capability -->
<!-- SLA Compliance metrics - Total requests processed under SLA, Total requests that breached SLA - Admin only -->
