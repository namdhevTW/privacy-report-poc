<div [ngClass]="dataForModal && dataForModal.length>0 ? 'p-0' : 'p-6' ">
  <div class="flex mb-4 justify-end">
    <!-- Settings & tools -->
     <span nz-icon nzType="reload" nzTheme="outline" class="p-2 cursor-pointer" (click)="loadPrivacyTableData()" (keypress)="loadPrivacyTableData()"></span>
     <a nz-tooltip class="p-2 border border-emerald-300 hover:text-black bg-emerald-200 rounded" (click)="exportDataAsCSV()">
      <span class="pr-2 font-semibold">Export data</span>
      <span nz-icon nzType="export" nzTheme="outline"></span>
     </a>
  </div>
  <nz-table nzBordered #tracingTable [nzData]="tableData" [nzPageSize]="pageSizeLimit" [nzShowPagination]="tableData.length > pageSizeLimit" >
    <thead>
      <tr>
        @for (col of colDefs; track col) {
          @if (col.name === 'requestCreatedDate') {
          <th
            *ngIf="col.showCol"
            [nzSortFn]="col.sortFn"
            [nzSortOrder]="col.sortOrder"
            [nzSortFn]="col.sortFn"
            [nzSortDirections]="col.sortDirections"
            [nzFilterMultiple]="col.filterMultiple"
            [nzShowFilter]="col.showFilter"
            [nzFilters]="col.listOfFilter"
            [nzFilterFn]="col.filterFn"
            [nzShowSort]="col.showSort"
            scope="col"
            nzAlign="center">
            {{col.name}}</th>
          }
          @else {
          <th
            *ngIf="col.showCol"
            [nzSortFn]="col.sortFn"
            [nzSortOrder]="col.sortOrder"
            [nzSortFn]="col.sortFn"
            [nzSortDirections]="col.sortDirections"
            [nzFilterMultiple]="col.filterMultiple"
            [nzFilters]="col.listOfFilter"
            [nzShowFilter]="col.showFilter"
            [nzShowSort]="col.showSort"
            [nzFilterFn]="col.filterFn"
            scope="col"
            nzAlign="center">
            {{col.name}}</th>
          }
        }
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let privData of tracingTable.data">
        <td *ngIf="isColumnVisible('requestId')">{{ privData.requestId }}</td>
        <td *ngIf="isColumnVisible('requestType')">{{ privData.requestType }}</td>
        <td *ngIf="isColumnVisible('currentStage')">{{ privData.currentStage }}</td>
        <td *ngIf="isColumnVisible('serviceOwner')"> {{privData.serviceOwner}}</td>
        <td *ngIf="isColumnVisible('state')">{{displayFullState(privData.state)}}</td>
        <td *ngIf="isColumnVisible('slaDays')">{{privData.slaDays}}</td>
        <td *ngIf="isColumnVisible('requestCreatedDate')">{{ privData.requestCreatedDate | date: 'dd-MMM-yyyy' }}</td>
        <td *ngIf="isColumnVisible('requestCompletedDate')">{{privData.requestCompletedDate | date: 'dd-MMM-yyyy' }}</td>
      </tr>
    </tbody>
  </nz-table>
</div>
